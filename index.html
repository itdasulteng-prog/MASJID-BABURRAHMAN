<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Donasi Masjid Baburrahman</title>
  <style>
    body { margin:0; font-family:'Segoe UI', sans-serif; background:#f3f3f3; }
    .hero {
      background:url('foto6.jpg') center/cover no-repeat;
      height:60vh; display:flex; align-items:center; justify-content:center;
      text-align:center; color:white; padding:20px; position:relative;
    }
    .hero::after {
      content:""; position:absolute; inset:0; background:rgba(0,0,0,0.55);
    }
    .hero-content { position:relative; z-index:2; }
    .hero h1 { font-size:2.5rem; margin:0; color:#ffd700; }
    .hero p { font-size:1.2rem; margin-top:10px; }
    .box {
      max-width:900px; margin:40px auto; background:white; padding:30px;
      border-radius:16px; box-shadow:0 6px 20px rgba(0,0,0,0.1);
    }
    .progress-container {
      background:#eaeaea; border-radius:20px; height:22px; overflow:hidden;
      margin-top:10px;
    }
    .progress {
      background:linear-gradient(90deg,#1a8754,#44c06f);
      height:100%; width:40%;
    }
    .qr { text-align:center; margin:20px 0; }
    .qr img {
      width:250px; border-radius:12px; background:white; padding:10px;
      border:1px solid #ddd;
    }
    .btn {
      display:inline-block; padding:14px 28px; background:#1A8754; color:white;
      text-decoration:none; border-radius:10px; font-weight:bold; transition:0.3s;
    }
    .btn:hover { background:#14633f; }
    .gallery {
      display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      gap:15px; margin-top:20px;
    }
    .gallery img {
      width:100%; border-radius:12px; height:180px; object-fit:cover;
      box-shadow:0 4px 10px rgba(0,0,0,0.1);
    }
  </style>
  <!-- Open Graph for WhatsApp/Facebook Preview -->
<meta property="og:title" content="Mesjid Baburrahman Dusun Pontung - Walea Besar">
<meta property="og:description" content="Galang dana pembangunan Mesjid Baburrahman Dusun Pontung, Kecamatan Walea Besar, Kabupaten Tojo Una-Una. Ayo turut beramal jariyah.">
<meta property="og:image" content="https://itdasulteng-prog.github.io/MASJID-BABURRAHMAN/images/preview-masjid.jpg">
<meta property="og:url" content="https://itdasulteng-prog.github.io/MASJID-BABURRAHMAN/">
<meta property="og:type" content="website">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://itdasulteng-prog.github.io/MASJID-BABURRAHMAN/images/preview-masjid.jpg">

</head>
<body>

<div class="hero">
  <div class="hero-content">
    <h1>MASJID BABURRAHMAN</h1>
    <h2>Dusun Pontung, Desa Pasokan, Kec. Walea Besar, Kab. Tojo Una-Una</h2>
    <p>“Jika seseorang meninggal dunia, 
      maka terputuslah amalannya kecuali tiga perkara yaitu: 
      sedekah jariyah, ilmu yang dimanfaatkan, 
      atau do’a anak yang sholeh” (HR. Muslim no. 1631)</p>
  </div>
</div>

<div class="box">
  <h2>Donasi Pembangunan & Kegiatan Masjid</h2>
  <p>
    Masjid Baburrahman yang terletak di Dusun Pontung, 
Desa Pasokan, Kec. Walea Besar Kab. Tojo Una Una, 
membuka kesempatan bagi jamaah dan kaum muslimin 
untuk berpartisipasi dalam pembangunan, renovasi, 
dan kegiatan operasional masjid.
  </p>

  <h3>Target Donasi</h3>
  <p><strong>Terkumpul: Rp 5.250.000,00 / Target: Rp 464.458.900</strong></p>

  <div class="progress-container"><div class="progress"></div></div>

  <h3 style="margin-top:30px;">Donasi via QRIS</h3>
  <div class="qr">
    <img src="qris.png" alt="QRIS Donasi Masjid Baburrahman">
  </div>

  <h3>Rekening Bank</h3>
  <p>
    <strong>Bank Sulteng</strong><br>
    No. Rekening: <strong>3010207182485</strong><br>
    a.n. <strong>Masjid Baburrahman</strong>
  </p>

  <a class="btn" href="https://wa.me/6285394750597" target="_blank">
    Konfirmasi Donasi via WhatsApp
  </a>
</div>

<div class="box">
  <h2>Galeri Kegiatan Masjid</h2>
  <div class="gallery">
    <img src="foto1.jpg" alt="Kegiatan 1">
    <img src="foto2.jpg" alt="Kegiatan 2">
    <img src="foto3.jpg" alt="Kegiatan 3">
    <img src="foto4.jpg" alt="Kegiatan 4">
    <img src="foto5.jpg" alt="Kegiatan 5">
    <img src="foto6.jpg" alt="Kegiatan 6">
    <img src="foto7.jpg" alt="Kegiatan 7">
    <img src="foto8.jpg" alt="Kegiatan 8">
    <img src="foto9.jpg" alt="Kegiatan 10">
     <img src="masjid-lama.jpg" alt="Kegiatan 9">

<div class="box">
  <h2>Foto Desain Perencanaan Pembangunan Masjid</h2>
  <div class="gallery">
    <img src="desain1.jpg" alt="Kegiatan 1">
    <img src="desain2.jpg" alt="Kegiatan 2">
    <img src="desain3.jpg" alt="Kegiatan 3">
    <img src="desain4.jpg" alt="Kegiatan 4">
    <img src="desain5.jpg" alt="Kegiatan 5">
    <img src="desain5.jpg" alt="Kegiatan 6">
    
    <div class="box">
  <h4>Sekilas Vidio Perjalanan ke Lokasi Masjid 
    Baburrahman Dusun Pontung, Desa Pasokan</h4>  
<video width="100%" controls>
  <source src="Perjalanan.mp4" type="video/mp4">
  Browser Anda tidak mendukung video.
</video>
</div>
 
   <div class="box">
  <h4>Kumpulan Video Kegiatan Pembangunan Masjid</h4>  

  <video width="100%" controls>
    <source src="rapat.mp4" type="video/mp4">
    Browser Anda tidak mendukung video.
  </video>

  <br><br>

  <video width="100%" controls>
    <source src="kerja.mp4" type="video/mp4">
    Browser Anda tidak mendukung video.
  </video>
</div>
</div>
  
<br><br>

  <video width="100%" controls>
    <source src="kerja1.mp4" type="video/mp4">
    Browser Anda tidak mendukung video.
  </video>
</div>
</div>
  
<div class="box">
  <h2>Video tentang Kec. Walea Besar</h2>
  <div style="text-align:center; margin: 20px 0;">
      <iframe 
          width="100%" 
          height="315" 
          src="https://www.youtube.com/embed/nov_vGMJ1fg" 
          title="Video Pembangunan Masjid Baburrahman" 
          frameborder="0" 
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
          allowfullscreen>
      </iframe>
  </div>
</div>
<div class="box">
  <h2>Daftar Donatur</h2>
  <table style="width:100%; border-collapse: collapse;">
    <tr>
      <th style="text-align:left; padding:8px; border-bottom:1px solid #ddd;">Nama</th>
      <th style="text-align:left; padding:8px; border-bottom:1px solid #ddd;">Nominal</th>
    </tr>
    <tr>
      <td style="padding:8px; border-bottom:1px solid #ddd;">hamba Allah</td>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Rp 100.000</td>
      </tr>
    <tr>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Znd</td>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Rp 100.000</td>
      </tr>
    <tr>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Pak Andika</td>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Rp 500.000</td>
      </tr>
    <tr>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Hamba Allah</td>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Rp 800.000</td>
      </tr>
    <tr>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Hamba Allah</td>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Rp 3.000.000</td>
      </tr>
    <tr>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Silpa</td>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Rp 500.000</td>
       </tr>
    <tr>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Muhammad Akbar Laebo</td>
      <td style="padding:8px; border-bottom:1px solid #ddd;">Rp 250.000</td>
    </tr>
  </table>
</div>
<!-- COMMENTS (Firebase + Admin Reply) -->
<h2>Komentar Pengunjung</h2>
<div class="comment-box" id="commentSection">
  <div id="commentControls" style="margin-bottom:10px;">
    <input type="text" id="visitorName" placeholder="Nama Anda" style="width:48%; padding:8px; margin-right:4%;">
    <input type="text" id="visitorPhone" placeholder="Nomor WA (opsional)" style="width:48%; padding:8px;">
    <textarea id="visitorMsg" placeholder="Tulis komentar..." style="width:100%; height:80px; padding:8px; margin-top:8px;"></textarea>
    <button id="sendCommentBtn" style="margin-top:8px; width:100%; padding:10px; background:#2b7a0b; color:white; border:none; border-radius:5px;">Kirim Komentar</button>
    <div style="margin-top:8px; display:flex; gap:8px;">
      <button id="adminLoginBtn" style="flex:1; padding:8px;">Login Admin</button>
      <button id="adminLogoutBtn" style="flex:1; padding:8px; display:none; background:#c0392b; color:white;">Logout Admin</button>
    </div>
  </div>

  <div id="commentsList" style="margin-top:12px;"></div>
</div>

<!-- Firebase + App logic -->
<script type="module">
  // === FIREBASE CONFIG (gunakan config yang Anda berikan) ===
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import {
    getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp,
    doc, addDoc as addSubDoc, deleteDoc
  } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDUmbTnwFI6MMGsnCrOJUnG_x_p3gPX0pw",
    authDomain: "beri-masukan.firebaseapp.com",
    projectId: "beri-masukan",
    storageBucket: "beri-masukan.firebasestorage.app",
    messagingSenderId: "970196231094",
    appId: "1:970196231094:web:c5965cdf119097ae495717",
    measurementId: "G-SS8LXE864M"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Admin password (sesuai permintaan Anda)
  const ADMIN_PASSWORD = "D4rm4w4nt0";

  // DOM
  const sendBtn = document.getElementById("sendCommentBtn");
  const nameInput = document.getElementById("visitorName");
  const phoneInput = document.getElementById("visitorPhone");
  const msgInput = document.getElementById("visitorMsg");
  const commentsList = document.getElementById("commentsList");
  const adminLoginBtn = document.getElementById("adminLoginBtn");
  const adminLogoutBtn = document.getElementById("adminLogoutBtn");

  // helper: check if admin (sessionStorage)
  function isAdmin() {
    return sessionStorage.getItem("masjid_is_admin") === "1";
  }

  function setAdminUI() {
    if (isAdmin()) {
      adminLoginBtn.style.display = "none";
      adminLogoutBtn.style.display = "inline-block";
    } else {
      adminLoginBtn.style.display = "inline-block";
      adminLogoutBtn.style.display = "none";
    }
  }

  // admin login prompt
  adminLoginBtn.addEventListener("click", () => {
    const p = prompt("Masukkan password admin:");
    if (p === ADMIN_PASSWORD) {
      sessionStorage.setItem("masjid_is_admin", "1");
      alert("Login admin berhasil — Anda dapat membalas atau menghapus komentar.");
      setAdminUI();
    } else {
      alert("Password salah.");
    }
  });

  adminLogoutBtn.addEventListener("click", () => {
    sessionStorage.removeItem("masjid_is_admin");
    setAdminUI();
    alert("Anda telah logout sebagai admin.");
  });

  setAdminUI();

  // Submit comment
  sendBtn.addEventListener("click", async () => {
    const name = nameInput.value.trim();
    const phone = phoneInput.value.trim();
    const text = msgInput.value.trim();
    if (!name || !text) { alert("Nama dan komentar wajib diisi."); return; }

    // save to Firestore collection 'comments'
    try {
      await addDoc(collection(db, "comments"), {
        name, phone, text,
        createdAt: serverTimestamp()
      });
      nameInput.value = ""; phoneInput.value = ""; msgInput.value = "";
    } catch (e) {
      console.error("Gagal kirim komentar:", e);
      alert("Gagal mengirim komentar. Coba lagi.");
    }
  });

  // Render a single comment + replies
  function renderComment(docSnap) {
    const data = docSnap.data();
    const id = docSnap.id;

    // comment container
    const wrap = document.createElement("div");
    wrap.style.background = "#fff";
    wrap.style.borderRadius = "8px";
    wrap.style.padding = "10px";
    wrap.style.marginBottom = "10px";
    wrap.style.boxShadow = "0 1px 4px rgba(0,0,0,0.06)";

    const header = document.createElement("div");
    header.innerHTML = `<strong>${escapeHtml(data.name || "Anonim")}</strong> <small style="color:#666; margin-left:8px;">${data.phone ? escapeHtml(data.phone) : ""}</small>`;
    wrap.appendChild(header);

    const body = document.createElement("div");
    body.style.marginTop = "6px";
    body.textContent = data.text || "";
    wrap.appendChild(body);

    // replies container
    const repliesWrap = document.createElement("div");
    repliesWrap.style.marginTop = "10px";
    repliesWrap.style.marginLeft = "10px";
    repliesWrap.id = "replies-" + id;
    wrap.appendChild(repliesWrap);

    // admin controls (reply & delete) - shown only if admin
    const ctrl = document.createElement("div");
    ctrl.style.marginTop = "8px";
    if (isAdmin()) {
      const replyBtn = document.createElement("button");
      replyBtn.textContent = "Balas (Admin)";
      replyBtn.style.marginRight = "8px";
      replyBtn.style.padding = "6px 8px";

      const delBtn = document.createElement("button");
      delBtn.textContent = "Hapus";
      delBtn.style.padding = "6px 8px";
      delBtn.style.background = "#c0392b";
      delBtn.style.color = "#fff";
      delBtn.style.border = "none";

      // reply form (initially hidden)
      const replyArea = document.createElement("div");
      replyArea.style.display = "none";
      replyArea.style.marginTop = "8px";

      const replyInput = document.createElement("textarea");
      replyInput.style.width = "100%";
      replyInput.style.height = "60px";
      replyInput.placeholder = "Tulis balasan admin...";

      const replySend = document.createElement("button");
      replySend.textContent = "Kirim Balasan";
      replySend.style.marginTop = "6px";
      replySend.style.padding = "8px";
      replySend.style.background = "#2b7a0b";
      replySend.style.color = "#fff";
      replySend.style.border = "none";

      replyBtn.addEventListener("click", () => {
        replyArea.style.display = replyArea.style.display === "none" ? "block" : "none";
      });

      replySend.addEventListener("click", async () => {
        const txt = replyInput.value.trim();
        if (!txt) { alert("Balasan kosong."); return; }
        try {
          await addSubDoc(collection(db, "comments", id, "replies"), {
            admin: true,
            text: txt,
            createdAt: serverTimestamp()
          });
          replyInput.value = "";
          replyArea.style.display = "none";
        } catch (e) {
          console.error(e);
          alert("Gagal mengirim balasan.");
        }
      });

      delBtn.addEventListener("click", async () => {
        if (!confirm("Hapus komentar ini?")) return;
        try {
          // delete all replies first is optional for cleanup (not implemented here)
          await deleteDoc(doc(db, "comments", id));
          // UI will auto-update via snapshot listener
        } catch (e) {
          console.error(e);
          alert("Gagal menghapus komentar.");
        }
      });

      replyArea.appendChild(replyInput);
      replyArea.appendChild(replySend);

      ctrl.appendChild(replyBtn);
      ctrl.appendChild(delBtn);
      ctrl.appendChild(replyArea);
    } else {
      // show "Balas" button that invites to admin login
      const hint = document.createElement("div");
      hint.style.marginTop = "8px";
      hint.style.color = "#666";
      hint.textContent = "Jika Anda admin, silakan login untuk membalas.";
      ctrl.appendChild(hint);
    }

    wrap.appendChild(ctrl);

    // replace or append
    wrap.setAttribute("data-id", id);
    return { wrap, repliesWrap };
  }

  // escape
  function escapeHtml(str) {
    return str.replaceAll && str.replaceAll(/[&<>"']/g, (m) => {
      return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m];
    });
  }

  // Real-time listener for comments
  const q = query(collection(db, "comments"), orderBy("createdAt", "desc"));
  onSnapshot(q, (snapshot) => {
    commentsList.innerHTML = "";
    snapshot.forEach((docSnap) => {
      const { wrap, repliesWrap } = renderComment(docSnap);
      commentsList.appendChild(wrap);

      // realtime listener for replies for this comment
      const repliesQ = query(collection(db, "comments", docSnap.id, "replies"), orderBy("createdAt", "asc"));
      onSnapshot(repliesQ, (rSnap) => {
        repliesWrap.innerHTML = "";
        rSnap.forEach((rDoc) => {
          const r = rDoc.data();
          const el = document.createElement("div");
          el.style.background = r.admin ? "#f1f8ee" : "#f7f7f7";
          el.style.padding = "8px";
          el.style.borderRadius = "6px";
          el.style.marginBottom = "6px";
          el.innerHTML = `<small style="color:#2b7a0b;"><b>${r.admin ? "Admin" : "Balasan"}</b></small><div style="margin-top:4px;">${escapeHtml(r.text || "")}</div>`;
          repliesWrap.appendChild(el);
        });
      }, (err) => console.error(err));
    });
  }, (err) => console.error(err));
</script>

</script>
</div>


</body>
</html>
